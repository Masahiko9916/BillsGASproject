# カレンダー登録エラーの原因

## 事象の整理
- カレンダー登録メニューを「sano@bills2018.net」で実行すると、「エラー登録」というダイアログが出て処理が止まる。
- 実行ログには `実行をキャンセルしました` と記録され、ステータスは「未対応」のまま更新されない。
- 同じ操作を「Ijgn@bills2018.net」で実行すると問題なくステータスが更新され、カレンダー登録も完了する。

## 原因
カレンダー登録処理の途中で `setRowValues_` ヘルパーを使ってステータスや最終更新情報を更新しています。旧実装の `setRowValues_` は、指定された列だけを書き換えれば良い場面でも、`sh.getRange(row, 1, 1, headerInfo.lastCol).setValues([rowValues]);` を呼び出し、行全体を書き戻していました。そのため、

1. 行の中に「管理列」など保護された列が含まれている。
2. `sano@bills2018.net` にはその保護列を編集する権限がない。
3. それでも行全体を一括で書き換えようとするため、スプレッドシート側で「保護されたセルは編集できません」というエラーが発生し、GAS 実行が `実行をキャンセルしました` で終了する。
4. 一方で、十分な権限を持つ `Ijgn@bills2018.net` は保護列にも書き込み可能なため、同じ処理が正常に完了する。

### 保護されている列の具体例

権限が制限されているのは、運用上ユーザーに直接編集させたくない以下の列です。

- **管理列（A～G列）**: `ステータス`, `回収予定日`, `開始時間`, `終了時間`, `回収担当者`, `エリア`, `受付連絡ステータス`
- **システム列**: `受付ID`, `行URL`, `最終更新者`, `最終更新時刻`, `削除日時`, `削除元`, `最終更新元`
- **カレンダー連携列**: `カレンダーイベントID`, `カレンダーID`

これらの列は `Config.gs V4.2.js` 内の定数（`MGMT_HEADERS`, `SYS_HEADERS_MAIN`, `CALENDAR_HEADERS`）として定義されており、シート側でも保護設定がかかっています。【参考: `Config.gs V4.2.js`】

## 対応方針
保護列に触れないよう、実際に更新が必要な列だけを抜き出して `setValues` する（連続する列はまとめて書き込む）ことで、権限のない列を触らずにステータス変更とカレンダー登録を通すことができます。今回の修正では `setRowValues_` をそのように変更し、キャッシュの整合性も保つようになっています。 【参考: `SheetUtils.gs V4.js` の `setRowValues_` 実装】
